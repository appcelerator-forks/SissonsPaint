function ucfirst(e){return e?e[0].toUpperCase()+e.substr(1):e}function addNamespace(e){return(CONST.IMPLICIT_NAMESPACES[e]||CONST.NAMESPACE_DEFAULT)+"."+e}function processStyle(e,t,i,o,a){o=o||{},o.classes=i,t.apiName&&(o.apiName=t.apiName),t.id&&(o.id=t.id),t.applyProperties(exports.createStyle(e,o,a)),t.classes=i}function isTabletFallback(){return Math.min(Ti.Platform.displayCaps.platformHeight,Ti.Platform.displayCaps.platformWidth)>=700}function deepExtend(){var e,t,i,o,a,r,l=arguments[0]||{},n=1,s=arguments.length,d=!1;for("boolean"==typeof l&&(d=l,l=arguments[1]||{},n=2),"object"==typeof l||_.isFunction(l)||(l={});s>n;n++)if(e=arguments[n],null!=e){"string"==typeof e&&(e=e.split(""));for(t in e)i=l[t],o=e[t],l!==o&&(d&&o&&(_.isObject(o)&&!_.has(o,"apiName")||(a=_.isArray(o)))&&!o.colors?(a?(a=!1,r=i&&_.isArray(i)?i:[]):r=_.isDate(o)?new Date(o.valueOf()):i&&_.isObject(i)?i:{},l[t]=deepExtend(d,r,o)):"undefined"!=typeof o?l[t]=o:o.colors&&(l[t]=o))}return l}var _=require("alloy/underscore")._,Backbone=require("alloy/backbone"),CONST=require("alloy/constants");exports.version="1.5.1",exports._=_,exports.Backbone=Backbone;var DEFAULT_WIDGET="widget",TI_VERSION=Ti.version,MW320_CHECK=!1,IDENTITY_TRANSFORM=Ti.UI.create2DMatrix(),RESET={bottom:null,left:null,right:null,top:null,height:null,width:null,shadowColor:null,shadowOffset:null,backgroundImage:null,backgroundRepeat:null,center:null,layout:null,backgroundSelectedColor:null,backgroundSelectedImage:null,opacity:1,touchEnabled:!0,enabled:!0,horizontalWrap:!0,zIndex:0,backgroundColor:"transparent",font:null,visible:!0,color:"#000",transform:IDENTITY_TRANSFORM,backgroundGradient:null,borderColor:null,borderRadius:null,borderWidth:null};RESET=_.extend(RESET,{backgroundDisabledColor:null,backgroundDisabledImage:null,backgroundFocusedColor:null,backgroundFocusedImage:null,focusable:!1,keepScreenOn:!1}),exports.M=function(e,t,i){var o,a=(t||{}).config||{},r=a.adapter||{},l={},n={};r.type?(o=require("alloy/sync/"+r.type),l.sync=function(e,t,i){o.sync(e,t,i)}):l.sync=function(e,t){Ti.API.warn("Execution of "+e+"#sync() function on a model that does not support persistence"),Ti.API.warn("model: "+JSON.stringify(t.toJSON()))},l.defaults=a.defaults,i&&(n.migrations=i),o&&_.isFunction(o.beforeModelCreate)&&(a=o.beforeModelCreate(a,e)||a);var s=Backbone.Model.extend(l,n);return s.prototype.config=a,_.isFunction(t.extendModel)&&(s=t.extendModel(s)||s),o&&_.isFunction(o.afterModelCreate)&&o.afterModelCreate(s,e),s},exports.C=function(e,t,i){var o,a={model:i},r=(i?i.prototype.config:{})||{};r.adapter&&r.adapter.type?(o=require("alloy/sync/"+r.adapter.type),a.sync=function(e,t,i){o.sync(e,t,i)}):a.sync=function(e,t){Ti.API.warn("Execution of "+e+"#sync() function on a collection that does not support persistence"),Ti.API.warn("model: "+JSON.stringify(t.toJSON()))};var l=Backbone.Collection.extend(a);return l.prototype.config=r,_.isFunction(t.extendCollection)&&(l=t.extendCollection(l)||l),o&&_.isFunction(o.afterCollectionCreate)&&o.afterCollectionCreate(l),l},exports.UI={},exports.UI.create=function(controller,apiName,opts){opts=opts||{};var baseName,ns,parts=apiName.split(".");if(1===parts.length)baseName=apiName,ns=opts.ns||CONST.IMPLICIT_NAMESPACES[baseName]||CONST.NAMESPACE_DEFAULT;else{if(!(parts.length>1))throw"Alloy.UI.create() failed: No API name was given in the second parameter";baseName=parts[parts.length-1],ns=parts.slice(0,parts.length-1).join(".")}opts.apiName=ns+"."+baseName,baseName=baseName[0].toUpperCase()+baseName.substr(1);var style=exports.createStyle(controller,opts);return eval(ns)["create"+baseName](style)},exports.createStyle=function(e,t,i){var o,a;if(!t)return{};o=_.isArray(t.classes)?t.classes.slice(0):_.isString(t.classes)?t.classes.split(/\s+/):[],a=t.apiName,a&&-1===a.indexOf(".")&&(a=addNamespace(a));var r;r=require(e&&_.isObject(e)?"alloy/widgets/"+e.widgetId+"/styles/"+e.name:"alloy/styles/"+e);var l,n,s={};for(l=0,n=r.length;n>l;l++){var d=r[l],c=d.key;if(d.isApi&&-1===c.indexOf(".")&&(c=(CONST.IMPLICIT_NAMESPACES[c]||CONST.NAMESPACE_DEFAULT)+"."+c),d.isId&&t.id&&d.key===t.id||d.isClass&&_.contains(o,d.key));else{if(!d.isApi)continue;if(-1===d.key.indexOf(".")&&(d.key=addNamespace(d.key)),d.key!==a)continue}d.queries&&d.queries.formFactor&&!Alloy[d.queries.formFactor]||deepExtend(!0,s,d.style)}var u=_.omit(t,[CONST.CLASS_PROPERTY,CONST.APINAME_PROPERTY]);return deepExtend(!0,s,u),s[CONST.CLASS_PROPERTY]=o,s[CONST.APINAME_PROPERTY]=a,MW320_CHECK&&delete s[CONST.APINAME_PROPERTY],i?_.defaults(s,i):s},exports.addClass=function(e,t,i,o){if(!i)return void(o&&(MW320_CHECK&&delete o.apiName,t.applyProperties(o)));var a=t[CONST.CLASS_PROPERTY]||[],r=a.length;i=_.isString(i)?i.split(/\s+/):i;var l=_.union(a,i||[]);return r===l.length?void(o&&(MW320_CHECK&&delete o.apiName,t.applyProperties(o))):void processStyle(e,t,l,o)},exports.removeClass=function(e,t,i,o){i=i||[];var a=t[CONST.CLASS_PROPERTY]||[],r=a.length;if(!r||!i.length)return void(o&&(MW320_CHECK&&delete o.apiName,t.applyProperties(o)));i=_.isString(i)?i.split(/\s+/):i;var l=_.difference(a,i);return r===l.length?void(o&&(MW320_CHECK&&delete o.apiName,t.applyProperties(o))):void processStyle(e,t,l,o,RESET)},exports.resetClass=function(e,t,i,o){i=i||[],i=_.isString(i)?i.split(/\s+/):i,processStyle(e,t,i,o,RESET)},exports.createWidget=function(e,t,i){return"undefined"!=typeof t&&null!==t&&_.isObject(t)&&!_.isString(t)&&(i=t,t=DEFAULT_WIDGET),new(require("alloy/widgets/"+e+"/controllers/"+(t||DEFAULT_WIDGET)))(i)},exports.createController=function(e,t){return new(require("alloy/controllers/"+e))(t)},exports.createModel=function(e,t){return new(require("alloy/models/"+ucfirst(e)).Model)(t)},exports.createCollection=function(e,t){return new(require("alloy/models/"+ucfirst(e)).Collection)(t)},exports.isTablet=function(){var e=Ti.Platform.Android.physicalSizeCategory;return e===Ti.Platform.Android.PHYSICAL_SIZE_CATEGORY_LARGE||e===Ti.Platform.Android.PHYSICAL_SIZE_CATEGORY_XLARGE}(),exports.isHandheld=!exports.isTablet,exports.Globals={},exports.Models={},exports.Models.instance=function(e){return exports.Models[e]||(exports.Models[e]=exports.createModel(e))},exports.Collections={},exports.Collections.instance=function(e){return exports.Collections[e]||(exports.Collections[e]=exports.createCollection(e))},exports.CFG=require("alloy/CFG"),exports.Android={},exports.Android.menuItemCreateArgs=["itemId","groupId","title","order","actionView","checkable","checked","enabled","icon","showAsAction","titleCondensed","visible"];