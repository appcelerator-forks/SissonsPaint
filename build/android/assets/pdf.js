function exists(e){try{if(e.exists())return!0}catch(t){console.log(t)}return!1}function isPdf(e){try{var t=e.read();if(!t)return!1;if(t.slice||(t=t.text),!t)return!1;if(0===t.indexOf("%PDF"))return!0}catch(i){console.log(i)}return!1}function download(e,t,i){var o=Ti.Utils.md5HexDigest(e)+".pdf",a=Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory,o);if(exists(a))return i(null,a,o,e);var r=Ti.Network.createHTTPClient();return r.onload=function(t){try{var o=Ti.Utils.md5HexDigest(e)+".pdf",a=Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory,o);if(200!=t.source.status)throw new Error("http status "+t.source.status);return a.write(t.source.responseData),i(null,a,o,e)}catch(t){return i(t)}},r.onerror=function(e){return i(e)},r.ondatastream=function(e){ind.value=e.progress,label.text=(100*ind.value).toFixed(0)+"% Downloading",Ti.API.info("ONSENDSTREAM - PROGRESS: "+e.progress)},r.setRequestHeader("Cookie",t),r.open("GET",e),r.send(),r}function copyToTemp(e,t,i){var o=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,t);o.createDirectory();var a=i.split("/");a=a[a.length-1];var r=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,t,a);return r.write(e.read()),r}function launch(e){var t=Ti.Android.createIntent({action:Ti.Android.ACTION_VIEW,data:e.getNativePath(),type:"application/pdf"});Ti.Android.currentActivity.startActivity(t)}function pdf(e,t,i,o,a){return ind=i,label=o,Ti.Filesystem.isExternalStoragePresent()?void download(e,t,function(e,t,i,o){if(e)return a(e);var r=copyToTemp(t,i,o);launch(r),a()}):a(new Error("external"))}var ind="",label="";module.exports=pdf;