function exists(e){try{if(e.exists())return!0}catch(t){console.log(t)}return!1}function isPdf(e){try{var t=e.read();if(!t)return!1;if(t.slice||(t=t.text),!t)return!1;if(console.log("first few characters of pdf file: "+t.slice(0,5)),0===t.indexOf("%PDF"))return!0}catch(i){console.log(i)}return console.log("IS Pdf "),!1}function download(e,t,i){var o=Ti.Utils.md5HexDigest(e)+".pdf",r=Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory,o);if(console.log(r),exists(r))return console.log("File already exists and is pdf, returning"),i(null,r,o,e);var n=Ti.Network.createHTTPClient();return n.onload=function(t){try{var o=Ti.Utils.md5HexDigest(e)+".pdf",r=Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory,o);if(200!=t.source.status)throw new Error("http status "+t.source.status);return r.write(t.source.responseData),i(null,r,o,e)}catch(t){return i(t)}},n.onerror=function(e){return console.log("http error "+e.source.status),i(e)},n.ondatastream=function(e){ind.value=e.progress,ind.message=(100*ind.value).toFixed(0)+"% Downloading",Ti.API.info("ONSENDSTREAM - PROGRESS: "+e.progress)},n.setRequestHeader("Cookie",t),n.open("GET",e),n.send(),n}function copyToTemp(e,t,i){var o=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,t);o.createDirectory();var r=i.split("/");r=r[r.length-1];var n=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,t,r);return n.write(e.read()),n}function launch(e){console.log("launching pdf path: "+e.getNativePath());var t=Ti.Android.createIntent({action:Ti.Android.ACTION_VIEW,data:e.getNativePath(),type:"application/pdf"});Ti.Android.currentActivity.startActivity(t)}function pdf(e,t,i,o){return ind=i,Ti.Filesystem.isExternalStoragePresent()?void download(e,t,function(e,t,i,r){if(e)return o(e);var n=copyToTemp(t,i,r);launch(n),o()}):o(new Error("external"))}var ind="";module.exports=pdf;