function exists(e){try{if(e.exists())return!0}catch(t){console.log(t)}return!1}function isPdf(e){try{var t=e.read();if(!t)return!1;if(t.slice||(t=t.text),!t)return!1;if(console.log("first few characters of pdf file: "+t.slice(0,5)),0===t.indexOf("%PDF"))return!0}catch(i){console.log(i)}return console.log("IS Pdf "),!1}function download(e,t,i){var o=Ti.Utils.md5HexDigest(e)+".pdf",r=Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory,o);if(console.log(r),exists(r))return console.log("File already exists and is pdf, returning"),i(null,r,o,e);var a=Ti.Network.createHTTPClient();return a.onload=function(t){try{var o=Ti.Utils.md5HexDigest(e)+".pdf",r=Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory,o);if(200!=t.source.status)throw new Error("http status "+t.source.status);return r.write(t.source.responseData),i(null,r,o,e)}catch(t){return i(t)}},a.onerror=function(e){return console.log("http error "+e.source.status),i(e)},a.setRequestHeader("Cookie",t),a.open("GET",e),a.send(),a}function copyToTemp(e,t,i){var o=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,t);o.createDirectory();var r=i.split("/");r=r[r.length-1];var a=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,t,r);return a.write(e.read()),a}function launch(e){console.log("launching pdf path: "+e.getNativePath());var t=Ti.Android.createIntent({action:Ti.Android.ACTION_VIEW,data:e.getNativePath(),type:"application/pdf"});Ti.Android.currentActivity.startActivity(t)}function pdf(e,t,i){return Ti.Filesystem.isExternalStoragePresent()?void download(e,t,function(e,t,o,r){if(e)return i(e);var a=copyToTemp(t,o,r);launch(a),i()}):i(new Error("external"))}module.exports=pdf;