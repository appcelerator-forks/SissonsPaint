var Alloy=require("alloy"),_=require("alloy/underscore")._,model,collection;exports.definition={config:{columns:{id:"INTEGER",title:"TEXT",cover:"TEXT",content:"TEXT",url:"TEXT",status:"INTEGER",isDownloaded:"INTEGER",format:"TEXT"},adapter:{type:"sql",collection_name:"brochure"}},extendModel:function(e){return _.extend(e.prototype,{}),e},extendCollection:function(e){return _.extend(e.prototype,{getBrochureList:function(){var e=this,t="SELECT * FROM "+e.config.adapter.collection_name+"  order by id DESC";db=Ti.Database.open(e.config.adapter.db_name);for(var i=db.execute(t),o=[],a=0;i.isValidRow();)o[a]={id:i.fieldByName("id"),title:i.fieldByName("title"),cover:i.fieldByName("cover"),content:i.fieldByName("content"),url:i.fieldByName("url"),isDownloaded:i.fieldByName("isDownloaded"),status:i.fieldByName("status"),format:i.fieldByName("format")},i.next(),a++;return i.close(),db.close(),e.trigger("sync"),o},addBrochure:function(e,t,i,o,a,r,l){var n=this,_="SELECT * FROM "+n.config.adapter.collection_name+" WHERE id="+e,s="";db=Ti.Database.open(n.config.adapter.db_name);var d=db.execute(_);s=d.isValidRow()?"UPDATE "+n.config.adapter.collection_name+" SET title='"+t+"', cover='"+i+"', content='"+o+"', status='"+r+"' WHERE id='"+e+"'":"INSERT INTO "+n.config.adapter.collection_name+" (id, title, cover,content, url,status, isDownloaded,format ) VALUES ('"+e+"','"+t+"','"+i+"','"+o+"','"+a+"','"+r+"', 0, '"+l+"')",db.execute(s),db.close(),n.trigger("sync")},updateDownloadedBrochure:function(e){var t=this;sql_query="UPDATE "+t.config.adapter.collection_name+" SET isDownloaded=1 WHERE id='"+e+"'",db=Ti.Database.open(t.config.adapter.db_name),db.execute(sql_query),db.close(),t.trigger("sync")},resetBrochure:function(){var e=this,t="DELETE FROM "+e.config.adapter.collection_name;db=Ti.Database.open(e.config.adapter.db_name),db.execute(t),db.close(),e.trigger("sync")}}),e}},model=Alloy.M("brochure",exports.definition,[]),collection=Alloy.C("brochure",exports.definition,model),exports.Model=model,exports.Collection=collection;