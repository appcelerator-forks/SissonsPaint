function __processArg(e,t){var i=null;return e&&(i=e[t]||null,delete e[t]),i}function Controller(){function e(){var e=Titanium.UI.createOptionDialog({title:"Choose an image source...",options:["Camera","Photo Gallery","Cancel"],cancel:2});e.addEventListener("click",function(e){0==e.index?Titanium.Media.showCamera({success:function(e){var t=e.media;e.mediaType==Ti.Media.MEDIA_TYPE_PHOTO&&(Ti.App.Properties.setString("colour_picker_image",t.nativePath),Ti.App.fireEvent("web:loadImage",{image:t.nativePath}))},cancel:function(){},error:function(e){var t=Titanium.UI.createAlertDialog({title:"Camera"});t.setMessage(e.code==Titanium.Media.NO_CAMERA?"Device does not have camera":"Unexpected error: "+e.code),t.show()},allowImageEditing:!0,saveToPhotoGallery:!0}):1==e.index&&Titanium.Media.openPhotoGallery({success:function(e){var t=e.media;e.mediaType==Ti.Media.MEDIA_TYPE_PHOTO&&(Ti.App.Properties.setString("colour_picker_image",t.nativePath),Ti.App.fireEvent("web:loadImage",{image:t.nativePath}))},cancel:function(){}})}),e.show()}function t(){a.colorSelection.visible?a.colorSelection.hide():a.colorSelection.show()}function i(){for(var e=Math.floor(Math.random()*p.length),t=g.getCategoryColourByCategory(p[e].id),i=50*Math.ceil(t.length)+10,o=Titanium.UI.createView({layout:"horizontal",bottom:10,height:40,width:i}),l=0;l<t.length;l++){var n=v.getColourById(t[l].colour_id),s=a.UI.create("View",{backgroundColor:"rgb("+n.rgb+")",borderColor:"#A5A5A5",borderWidth:1,width:"40",height:"40",left:"5",right:"5"}),_=g.getCateByColourId(n.id),d=w.getCategoryById(_.cate_id,"2");r(s,n,d),o.add(s)}a.recommendView.add(o)}function o(){removeAllChildren(a.scrollView);var e=50*I.length+20,t=Titanium.UI.createView({layout:"horizontal",height:40,width:e});console.log("details: "+I.length);for(var i=0;i<I.length;i++){var o=a.UI.create("View",{backgroundColor:"rgb("+I[i].rgb+")",borderColor:"#A5A5A5",borderWidth:1,width:"40",height:"40",left:"5",right:"5"}),l=g.getCateByColourId(I[i].id),n=w.getCategoryById(l.cate_id,"2");r(o,I[i],n),t.add(o)}a.loadingBar.opacity="0",a.loadingBar.height="0",a.loadingBar.top="0",a.scrollView.add(t),a.colorSelection.show()}function r(e,t,i){e.addEventListener("click",function(){Ti.App.Properties.setString("from","colourPicker");var e=Alloy.createController("colourDetails",{colour_details:t,details:i}).getView();e.open()})}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="colourPicker",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var a=this,l={},n={};a.__views.colourPicker=Ti.UI.createView({backgroundColor:"white",id:"colourPicker"}),a.__views.colourPicker&&a.addTopLevelView(a.__views.colourPicker),a.__views.toggle=Ti.UI.createView({layout:"horizontal",id:"toggle",top:"0",height:"80"}),a.__views.colourPicker.add(a.__views.toggle),a.__views.__alloyId40=Alloy.createController("toggle",{id:"__alloyId40",__parentSymbol:a.__views.toggle}),a.__views.__alloyId40.setParent(a.__views.toggle),a.__views.__alloyId41=Ti.UI.createLabel({width:"75%",height:"80",color:"black",font:{fontSize:22},text:"Colour Picker",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,id:"__alloyId41"}),a.__views.toggle.add(a.__views.__alloyId41),a.__views.canvas=Ti.UI.createWebView({id:"canvas",url:"/html/colour_picker.html",top:"80",height:"80%",enableZoomControls:"false",overScrollMode:Titanium.UI.Android.OVER_SCROLL_NEVER,disableBounce:"true"}),a.__views.colourPicker.add(a.__views.canvas),a.__views.loadingBar=Ti.UI.createView({layout:"vertical",id:"loadingBar",height:"0",width:"120",borderRadius:"15",top:"0",opacity:"1",backgroundColor:"#2E2E2E"}),a.__views.colourPicker.add(a.__views.loadingBar),a.__views.activityIndicator=Ti.UI.createActivityIndicator({style:Ti.UI.ActivityIndicatorStyle.BIG,top:15,left:30,width:60,id:"activityIndicator"}),a.__views.loadingBar.add(a.__views.activityIndicator),a.__views.__alloyId42=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"#ffffff",text:"Loading",id:"__alloyId42"}),a.__views.loadingBar.add(a.__views.__alloyId42),a.__views.colorSelection=Ti.UI.createView({layout:"vertical",height:"35%",bottom:"60",id:"colorSelection",visible:"false"}),a.__views.colourPicker.add(a.__views.colorSelection),a.__views.__alloyId43=Ti.UI.createImageView({image:"/images/scroll_up.png",backgroundColor:"transparent",width:Titanium.UI.FILL,top:"0",id:"__alloyId43"}),a.__views.colorSelection.add(a.__views.__alloyId43),a.__views.bottomColorBar=Ti.UI.createView({id:"bottomColorBar",layout:"vertical",backgroundColor:"white"}),a.__views.colorSelection.add(a.__views.bottomColorBar),a.__views.__alloyId44=Ti.UI.createLabel({width:"90%",height:Ti.UI.SIZE,color:"black",text:"COLOURS INSPIRATION",textAlign:Ti.UI.TEXT_ALIGNMENT_LEFT,bottom:"10",backgroundColor:"white",id:"__alloyId44"}),a.__views.bottomColorBar.add(a.__views.__alloyId44),a.__views.recommendView=Ti.UI.createScrollView({id:"recommendView",backgroundColor:"white",layout:"horizontal",scrollType:"horizontal",height:"50",overScrollMode:Titanium.UI.Android.OVER_SCROLL_NEVER}),a.__views.bottomColorBar.add(a.__views.recommendView),a.__views.__alloyId45=Ti.UI.createImageView({image:"/images/scroll_up.png",backgroundColor:"white",width:Titanium.UI.FILL,id:"__alloyId45"}),a.__views.bottomColorBar.add(a.__views.__alloyId45),a.__views.__alloyId46=Ti.UI.createLabel({width:"90%",height:Ti.UI.SIZE,color:"black",text:"CLOSEST COLOUR",textAlign:Ti.UI.TEXT_ALIGNMENT_LEFT,bottom:"10",backgroundColor:"white",id:"__alloyId46"}),a.__views.bottomColorBar.add(a.__views.__alloyId46),a.__views.scrollView=Ti.UI.createScrollView({id:"scrollView",backgroundColor:"white",layout:"horizontal",scrollType:"horizontal",height:"50",overScrollMode:Titanium.UI.Android.OVER_SCROLL_NEVER}),a.__views.bottomColorBar.add(a.__views.scrollView),a.__views.bottomBar=Ti.UI.createView({id:"bottomBar",bottom:"0",height:"60",width:Ti.UI.FILL,backgroundImage:"/images/tool_bar.jpg"}),a.__views.colourPicker.add(a.__views.bottomBar),a.__views.__alloyId47=Ti.UI.createView({layout:"horizontal",width:"120",id:"__alloyId47"}),a.__views.bottomBar.add(a.__views.__alloyId47),a.__views.takePhoto=Ti.UI.createImageView({image:"/images/icon_photo.png",right:"10",id:"takePhoto",width:"50",height:"40",top:"10",bottom:"10"}),a.__views.__alloyId47.add(a.__views.takePhoto),e?a.__views.takePhoto.addEventListener("click",e):n["$.__views.takePhoto!click!takePhoto"]=!0,a.__views.toggleActivation=Ti.UI.createImageView({image:"/images/btn_eyedrop.png",left:"10",id:"toggleActivation",width:"50",height:"40",top:"10",bottom:"10"}),a.__views.__alloyId47.add(a.__views.toggleActivation),t?a.__views.toggleActivation.addEventListener("click",t):n["$.__views.toggleActivation!click!toggleActivation"]=!0,l.destroy=function(){},_.extend(a,a.__views),arguments[0]||{};var s=require("facebook");s.appid=752094718209236,Ti.Platform.displayCaps.platformHeight;var d=Ti.Platform.displayCaps.platformWidth,c=PixelsToDPUnits(Ti.Platform.displayCaps.platformHeight),h=a.toggle.getHeight(),u=c-h,g=Alloy.createCollection("category_colour"),v=Alloy.createCollection("colour"),I="",w=Alloy.createCollection("category"),p=w.getCategoryListByType(1);a.colorSelection.hide(),e(),a.canvas.addEventListener("load",function(){a.colorSelection.hide(),Ti.App.fireEvent("web:initCanvasSize",{height:u,width:d})}),1==Ti.App.Properties.getString("back")&&Ti.App.Properties.setString("back",0),i();var y=function(e){a.activityIndicator.show(),a.loadingBar.opacity="1",a.loadingBar.height="120",a.loadingBar.top=PixelsToDPUnits(Ti.Platform.displayCaps.platformHeight)/2-a.loadingBar.getHeight()/2,a.colorSelection.hide(),I=v.getClosestColourList(e.r,e.g,e.b),o()};Ti.App.addEventListener("app:getColour",y),n["$.__views.takePhoto!click!takePhoto"]&&a.__views.takePhoto.addEventListener("click",e),n["$.__views.toggleActivation!click!toggleActivation"]&&a.__views.toggleActivation.addEventListener("click",t),_.extend(a,l)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;