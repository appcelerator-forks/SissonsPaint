function __processArg(e,t){var i=null;return e&&(i=e[t]||null,delete e[t]),i}function Controller(){function e(){a.activityIndicator.hide(),a.loadingBar.opacity="0",a.loadingBar.height="0";var e=Titanium.UI.createOptionDialog({title:"Choose an image source...",options:["Camera","Photo Gallery","Cancel"],cancel:2});e.addEventListener("click",function(e){0==e.index?Titanium.Media.showCamera({success:function(e){var t=e.media;if(e.mediaType==Ti.Media.MEDIA_TYPE_PHOTO){var i=e.media.nativePath;d.rotateResizeImage(i,h,100),Ti.App.Properties.setString("colour_picker_image",t.nativePath),Ti.App.fireEvent("web:loadImage",{image:t.nativePath})}},cancel:function(){},error:function(e){var t=Titanium.UI.createAlertDialog({title:"Camera"});t.setMessage(e.code==Titanium.Media.NO_CAMERA?"Device does not have camera":"Unexpected error: "+e.code),t.show()},allowImageEditing:!0,saveToPhotoGallery:!0}):1==e.index&&Titanium.Media.openPhotoGallery({success:function(e){var t=e.media;e.mediaType==Ti.Media.MEDIA_TYPE_PHOTO&&(Ti.App.Properties.setString("colour_picker_image",t.nativePath),Ti.App.fireEvent("web:loadImage",{image:t.nativePath}))},cancel:function(){}})}),e.show()}function t(){a.colorSelection.visible?a.colorSelection.hide():a.colorSelection.show()}function i(){for(var e=Math.floor(Math.random()*m.length),t=v.getCategoryColourByCategory(m[e].id),i=50*Math.ceil(t.length)+10,o=Titanium.UI.createView({layout:"horizontal",bottom:10,height:40,width:i}),l=0;l<t.length;l++){var n,s=p.getColourById(t[l].colour_id);n=""!=s.thumb?a.UI.create("ImageView",{image:s.thumb,borderColor:"#A5A5A5",borderWidth:1,width:"40",height:"40",left:"5",right:"5"}):a.UI.create("View",{backgroundColor:"rgb("+s.rgb+")",borderColor:"#A5A5A5",borderWidth:1,width:"40",height:"40",left:"5",right:"5"});var _=v.getCateByColourId(s.id,"2"),d=y.getCategoryByIdOnly(_.cate_id);r(n,s,d),o.add(n)}a.recommendView.add(o)}function o(){removeAllChildren(a.scrollView);for(var e=50*I.length+20,t=Titanium.UI.createView({layout:"horizontal",height:40,width:e}),i=0;i<I.length;i++){var o;o=""!=I[i].thumb?a.UI.create("ImageView",{image:I[i].thumb,borderColor:"#A5A5A5",borderWidth:1,width:"40",height:"40",left:"5",right:"5"}):a.UI.create("View",{backgroundColor:"rgb("+I[i].rgb+")",borderColor:"#A5A5A5",borderWidth:1,width:"40",height:"40",left:"5",right:"5"});var l=v.getCateByColourId(I[i].id,"2"),n=y.getCategoryById(l.cate_id,"2");r(o,I[i],n),t.add(o)}a.loadingBar.opacity="0",a.loadingBar.height="0",a.loadingBar.top="0",a.scrollView.add(t),a.colorSelection.show()}function r(e,t,i){e.addEventListener("click",function(){Ti.App.Properties.setString("from","colourPicker");var e=Alloy.createController("colourDetails",{colour_details:t,details:i}).getView();e.open()})}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="colourPicker",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var a=this,l={},n={};a.__views.colourPicker=Ti.UI.createView({backgroundColor:"white",id:"colourPicker"}),a.__views.colourPicker&&a.addTopLevelView(a.__views.colourPicker),a.__views.toggle=Ti.UI.createView({layout:"horizontal",id:"toggle",top:"0",height:"80",backgroundImage:"/images/banner_colour_picker.jpg"}),a.__views.colourPicker.add(a.__views.toggle),a.__views.__alloyId28=Alloy.createController("toggle",{id:"__alloyId28",__parentSymbol:a.__views.toggle}),a.__views.__alloyId28.setParent(a.__views.toggle),a.__views.canvas=Ti.UI.createWebView({id:"canvas",url:"/html/colour_picker.html",top:"80",height:"80%",enableZoomControls:"false",overScrollMode:Titanium.UI.Android.OVER_SCROLL_NEVER,disableBounce:"true"}),a.__views.colourPicker.add(a.__views.canvas),a.__views.loadingBar=Ti.UI.createView({layout:"vertical",id:"loadingBar",height:"0",width:"120",borderRadius:"15",top:"0",opacity:"1",backgroundColor:"#2E2E2E"}),a.__views.colourPicker.add(a.__views.loadingBar),a.__views.activityIndicator=Ti.UI.createActivityIndicator({style:Ti.UI.ActivityIndicatorStyle.BIG,top:15,left:30,width:60,id:"activityIndicator"}),a.__views.loadingBar.add(a.__views.activityIndicator),a.__views.__alloyId29=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"#ffffff",text:"Loading",id:"__alloyId29"}),a.__views.loadingBar.add(a.__views.__alloyId29),a.__views.colorSelection=Ti.UI.createView({layout:"vertical",height:"40%",bottom:"60",id:"colorSelection",visible:"false"}),a.__views.colourPicker.add(a.__views.colorSelection),a.__views.__alloyId30=Ti.UI.createImageView({image:"/images/scroll_up.png",backgroundColor:"transparent",width:Titanium.UI.FILL,top:"0",id:"__alloyId30"}),a.__views.colorSelection.add(a.__views.__alloyId30),a.__views.bottomColorBar=Ti.UI.createView({id:"bottomColorBar",layout:"vertical",backgroundColor:"white"}),a.__views.colorSelection.add(a.__views.bottomColorBar),a.__views.__alloyId31=Ti.UI.createLabel({width:"90%",height:Ti.UI.SIZE,color:"black",text:"COLOURS INSPIRATION",textAlign:Ti.UI.TEXT_ALIGNMENT_LEFT,bottom:"10",backgroundColor:"white",id:"__alloyId31"}),a.__views.bottomColorBar.add(a.__views.__alloyId31),a.__views.recommendView=Ti.UI.createScrollView({id:"recommendView",backgroundColor:"white",layout:"horizontal",scrollType:"horizontal",height:"50",overScrollMode:Titanium.UI.Android.OVER_SCROLL_NEVER}),a.__views.bottomColorBar.add(a.__views.recommendView),a.__views.__alloyId32=Ti.UI.createImageView({image:"/images/scroll_up.png",backgroundColor:"white",width:Titanium.UI.FILL,id:"__alloyId32"}),a.__views.bottomColorBar.add(a.__views.__alloyId32),a.__views.__alloyId33=Ti.UI.createLabel({width:"90%",height:Ti.UI.SIZE,color:"black",text:"CLOSEST COLOUR",textAlign:Ti.UI.TEXT_ALIGNMENT_LEFT,bottom:"10",backgroundColor:"white",id:"__alloyId33"}),a.__views.bottomColorBar.add(a.__views.__alloyId33),a.__views.scrollView=Ti.UI.createScrollView({id:"scrollView",backgroundColor:"white",layout:"horizontal",scrollType:"horizontal",height:"50",overScrollMode:Titanium.UI.Android.OVER_SCROLL_NEVER}),a.__views.bottomColorBar.add(a.__views.scrollView),a.__views.toolbar=Ti.UI.createView({height:"60",bottom:"0",id:"toolbar",width:"100%",backgroundImage:"/images/tool_bar.jpg"}),a.__views.colourPicker.add(a.__views.toolbar),a.__views.__alloyId34=Ti.UI.createView({layout:"horizontal",width:"100%",id:"__alloyId34"}),a.__views.toolbar.add(a.__views.__alloyId34),a.__views.__alloyId35=Ti.UI.createView({width:"30%",id:"__alloyId35"}),a.__views.__alloyId34.add(a.__views.__alloyId35),a.__views.__alloyId36=Ti.UI.createView({width:"20%",id:"__alloyId36"}),a.__views.__alloyId34.add(a.__views.__alloyId36),a.__views.takePhoto=Ti.UI.createImageView({id:"takePhoto",image:"/images/icon_photo.png",height:"40",width:"50",top:"10",bottom:"10"}),a.__views.__alloyId36.add(a.__views.takePhoto),e?a.__views.takePhoto.addEventListener("click",e):n["$.__views.takePhoto!click!takePhoto"]=!0,a.__views.__alloyId37=Ti.UI.createView({width:"20%",id:"__alloyId37"}),a.__views.__alloyId34.add(a.__views.__alloyId37),a.__views.toggleActivation=Ti.UI.createImageView({id:"toggleActivation",image:"/images/btn_eyedrop.png",height:"40",width:"50",top:"10",bottom:"10"}),a.__views.__alloyId37.add(a.__views.toggleActivation),t?a.__views.toggleActivation.addEventListener("click",t):n["$.__views.toggleActivation!click!toggleActivation"]=!0,a.__views.__alloyId38=Ti.UI.createView({width:"30%",id:"__alloyId38"}),a.__views.__alloyId34.add(a.__views.__alloyId38),a.__views.win=Ti.UI.createView({id:"win",height:"90%",width:"90%",backgroundColor:"transparent",theme:"Theme.NoActionBar",navBarHidden:"true",fullscreen:"true",borderColor:"#A5A5A5",borderWidth:"2",visible:"false"}),a.__views.colourPicker.add(a.__views.win);var s=[];a.__views.view1=Ti.UI.createView({id:"view1",backgroundColor:"#FFFFFF"}),s.push(a.__views.view1),a.__views.__alloyId40=Ti.UI.createImageView({image:"/images/tutorial/colorPicker/tutorial_picker1.jpg",width:"100%",id:"__alloyId40"}),a.__views.view1.add(a.__views.__alloyId40),a.__views.view2=Ti.UI.createView({id:"view2",backgroundColor:"#FFFFFF"}),s.push(a.__views.view2),a.__views.__alloyId41=Ti.UI.createImageView({image:"/images/tutorial/colorPicker/tutorial_picker2.jpg",width:"100%",id:"__alloyId41"}),a.__views.view2.add(a.__views.__alloyId41),a.__views.view3=Ti.UI.createView({id:"view3",backgroundColor:"#FFFFFF"}),s.push(a.__views.view3),a.__views.__alloyId42=Ti.UI.createImageView({image:"/images/tutorial/colorPicker/tutorial_picker3.jpg",width:"100%",id:"__alloyId42"}),a.__views.view3.add(a.__views.__alloyId42),a.__views.__alloyId43=Ti.UI.createView({layout:"horizontal",bottom:"4",height:Ti.UI.SIZE,width:Ti.UI.SIZE,id:"__alloyId43"}),a.__views.view3.add(a.__views.__alloyId43),a.__views.checkBox=Ti.UI.createSwitch({value:!0,id:"checkBox",style:Ti.UI.Android.SWITCH_STYLE_CHECKBOX}),a.__views.__alloyId43.add(a.__views.checkBox),a.__views.showWindow=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"black",text:"Don't show next time",left:"10",id:"showWindow"}),a.__views.__alloyId43.add(a.__views.showWindow),a.__views.scrollableView=Ti.UI.createScrollableView({views:s,id:"scrollableView",showPagingControl:"true",pagingControlTimeout:"0",overScrollMode:Titanium.UI.Android.OVER_SCROLL_NEVER}),a.__views.win.add(a.__views.scrollableView),l.destroy=function(){},_.extend(a,a.__views),arguments[0]||{};var d=require("fh.imagefactory"),c=require("facebook");c.appid=752094718209236,Ti.Platform.displayCaps.platformHeight;var h=Ti.Platform.displayCaps.platformWidth,u=PixelsToDPUnits(Ti.Platform.displayCaps.platformHeight),g=a.toggle.getHeight(),w=u-g,v=Alloy.createCollection("category_colour"),p=Alloy.createCollection("colour"),I="",y=Alloy.createCollection("category"),m=y.getCategoryListByType(1);a.activityIndicator.show(),a.loadingBar.opacity="1",a.loadingBar.height="120",a.loadingBar.top=PixelsToDPUnits(Ti.Platform.displayCaps.platformHeight)/2-a.loadingBar.getHeight()/2,a.colorSelection.hide(),setTimeout(function(){1==Ti.App.Properties.getString("pickerCheckBox")&&e(),i()},800),a.canvas.addEventListener("load",function(){a.colorSelection.hide(),Ti.App.fireEvent("web:initCanvasSize",{height:w,width:h})}),1==Ti.App.Properties.getString("back")&&Ti.App.Properties.setString("back",0);var f=function(e){a.activityIndicator.show(),a.loadingBar.opacity="1",a.loadingBar.height="120",a.loadingBar.top=PixelsToDPUnits(Ti.Platform.displayCaps.platformHeight)/2-a.loadingBar.getHeight()/2,a.colorSelection.hide(),I=p.getClosestColourList(e.r,e.g,e.b),o()};Ti.App.addEventListener("app:getColour",f),1==Ti.App.Properties.getString("pickerCheckBox")?a.win.hide():a.win.show();var T=Ti.UI.createImageView({image:"/images/icon_remove.png",width:30,height:30,top:0,right:0});a.view3.add(T),T.addEventListener("click",function(){a.win.hide(),e(),1==a.checkBox.value&&Ti.App.Properties.setString("pickerCheckBox",1)}),n["$.__views.takePhoto!click!takePhoto"]&&a.__views.takePhoto.addEventListener("click",e),n["$.__views.toggleActivation!click!toggleActivation"]&&a.__views.toggleActivation.addEventListener("click",t),_.extend(a,l)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;